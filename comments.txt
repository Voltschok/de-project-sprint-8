1. Вынес параметры подключения к Kafka и базе Postgres в файд config.ini
2. Разделил код на модули(функции) в соответствии с замечанием кроме функции foreach_batch_function. 
Здесь не совсем понял, зачем выделять отдельно функции для записи данных в  Kafka и отдельно функцию записи в Postgres, если, как мне казалось, смысл
  данной встроенной функции в возможности записывать данныеп в разные источники (предварительно кэшировав датафрейм.датасет)?
3. Добавил операцию try/except для обработки ошибок при подключении к базе Postgres
